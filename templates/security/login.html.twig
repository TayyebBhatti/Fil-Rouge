{% extends 'base.html.twig' %}
{% block title %}Connexion{% endblock %}

{% block stylesheets %}
<style>
  :root {
    --bg:#f6f8fb;
    --card:#ffffff;
    --text:#111827;
    --muted:#6b7280;
    --primary:#2563eb;
    --primary-hover:#1d4ed8;
    --border:#e5e7eb;
    --danger:#b91c1c;
  }
  * { box-sizing:border-box; }
  body { margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial,"Noto Sans",sans-serif; background:var(--bg); color:var(--text); }
  .auth-wrap { min-height:100dvh; display:grid; place-items:center; padding:24px; }
  .card { width:100%; max-width:440px; background:var(--card); border:1px solid var(--border); border-radius:12px; padding:24px; }
  h2 { margin:0 0 16px; font-size:22px; }
  form { display:grid; gap:16px; }
  label { display:block; font-size:14px; margin-bottom:6px; color:var(--muted); }
  input[type="email"], input[type="password"] {
    width:100%; padding:10px 12px; border:1px solid var(--border); border-radius:8px; background:#fff; font-size:14px;
  }
  input:focus { outline:none; border-color:var(--primary); box-shadow:0 0 0 3px rgba(37,99,235,.15); }
  .btn {
    display:inline-block; width:100%; padding:10px 14px; font-weight:600; text-align:center;
    color:#fff; background:var(--primary); border:0; border-radius:8px; cursor:pointer;
  }
  .btn:hover { background:var(--primary-hover); }
  .muted { color:var(--muted); font-size:14px; text-align:center; }
  .muted a { color:var(--primary); text-decoration:none; }
  .muted a:hover { text-decoration:underline; }
  .alert-danger { padding:10px 12px; border-radius:8px; font-size:14px; color:var(--danger); background:rgba(185,28,28,.06); border:1px solid rgba(185,28,28,.3); }
  .info { font-size:14px; color:var(--muted); }
  .info a { color:var(--primary); text-decoration:none; }
  .info a:hover { text-decoration:underline; }
</style>
{% endblock %}

{% block body %}
<div class="auth-wrap">
  <div class="card">
    <h2>Connexion</h2>

    {% if error %}
      <div class="alert-danger">
        {{ error.messageKey|trans(error.messageData, 'security') }}
      </div>
    {% endif %}

    {% if app.user %}
      <div class="info">
        Connecté en tant que {{ app.user.email }}.
        <a href="{{ path('app_logout') }}">Se déconnecter</a>
      </div>
    {% else %}
      <form method="post" action="{{ path('default_login') }}">
        <div>
          <label for="inputEmail">Email</label>
          <input type="email" id="inputEmail" name="_username" value="{{ last_username }}" required autofocus>
        </div>

        <div>
          <label for="inputPassword">Mot de passe</label>
          <input type="password" id="inputPassword" name="_password" required>
        </div>

        <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">
        <button class="btn" type="submit">Se connecter</button>

        <p class="muted">Pas de compte ?
          <a href="{{ path('default_inscription') }}">S'inscrire</a>
        </p>
      </form>
    {% endif %}
  </div>
</div>
{% endblock %}
